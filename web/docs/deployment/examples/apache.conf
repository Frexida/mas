# MAS-UI Apache Configuration Example
# Add this configuration to your Apache virtual host or sites configuration

# Alias for MAS-UI application
Alias "/mas-ui" "/var/www/mas-ui"  # Replace with your deployment path

<Directory "/var/www/mas-ui">
    Options FollowSymLinks
    AllowOverride None

    # Access control - adjust based on your requirements
    # For public access:
    Require all granted

    # For restricted access (example):
    # Require ip 10.0.0.0/8
    # Require ip 192.168.0.0/16
    # Require ip 127.0.0.1
    # Require ip ::1

    # SPA (Single Page Application) rewrite rules
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteBase /mas-ui/

        # Don't rewrite files or directories
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d

        # Rewrite everything else to index.html for client-side routing
        RewriteRule . /mas-ui/index.html [L]
    </IfModule>

    # Cache configuration for static assets
    <IfModule mod_expires.c>
        ExpiresActive On
        # Cache static assets for 1 year
        ExpiresByType application/javascript "access plus 1 year"
        ExpiresByType text/css "access plus 1 year"
        ExpiresByType image/png "access plus 1 year"
        ExpiresByType image/jpeg "access plus 1 year"
        ExpiresByType image/gif "access plus 1 year"
        ExpiresByType image/svg+xml "access plus 1 year"
        ExpiresByType font/woff "access plus 1 year"
        ExpiresByType font/woff2 "access plus 1 year"
        ExpiresByType application/font-woff "access plus 1 year"
        ExpiresByType application/font-woff2 "access plus 1 year"
    </IfModule>

    # Gzip compression
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/html
        AddOutputFilterByType DEFLATE text/css
        AddOutputFilterByType DEFLATE text/javascript
        AddOutputFilterByType DEFLATE application/javascript
        AddOutputFilterByType DEFLATE application/json
        AddOutputFilterByType DEFLATE application/xml
        AddOutputFilterByType DEFLATE image/svg+xml
    </IfModule>

    # Security headers
    <IfModule mod_headers.c>
        Header always set X-Frame-Options "SAMEORIGIN"
        Header always set X-Content-Type-Options "nosniff"
        Header always set X-XSS-Protection "1; mode=block"
        Header always set Referrer-Policy "strict-origin-when-cross-origin"
    </IfModule>
</Directory>

# Optional: API proxy configuration
# Uncomment and configure if you need to proxy API calls
# <Location "/api">
#     ProxyPass "http://localhost:3000/"
#     ProxyPassReverse "http://localhost:3000/"
#     ProxyPreserveHost On
#
#     # Add headers for proxied requests
#     RequestHeader set X-Forwarded-Proto "https"
#     RequestHeader set X-Forwarded-Port "443"
# </Location>

# Required Apache modules for this configuration:
# - mod_alias
# - mod_rewrite
# - mod_expires (optional, for caching)
# - mod_deflate (optional, for compression)
# - mod_headers (optional, for security headers)
# - mod_proxy (optional, for API proxy)
# - mod_proxy_http (optional, for API proxy)
#
# Enable modules with: a2enmod alias rewrite expires deflate headers proxy proxy_http